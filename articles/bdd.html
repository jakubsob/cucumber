<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Behavior-Driven Development • cucumber</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script src="bdd_files/libs/quarto-html/popper.min.js"></script><script src="bdd_files/libs/quarto-html/tippy.umd.min.js"></script><link href="bdd_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="bdd_files/libs/quarto-html/light-border.css" rel="stylesheet">
<!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Behavior-Driven Development">
<meta property="og:image" content="https://jakubsob.github.io/cucumber/logo.png">
<!-- Google tag (gtag.js) --><script async src="https://www.googletagmanager.com/gtag/js?id=G-N7MW34VJS3"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-N7MW34VJS3');
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">cucumber</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/reference-gherkin.html">Gherkin Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/bdd.html">Behavior-Driven Development</a></li>
    <li><a class="dropdown-item" href="../articles/how-it-works.html">How it works</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/jakubsob/cucumber/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-quarto">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Behavior-Driven Development</h1>




      <small class="dont-index">Source: <a href="https://github.com/jakubsob/cucumber/blob/main/vignettes/bdd.qmd" class="external-link"><code>vignettes/bdd.qmd</code></a></small>
      <div class="d-none name"><code></code></div>
    </div>






    <p>When developing software, a disconnect between what users want and what the software does can occur. We might’ve delivered working, tested code, but does it solve the user’s problem?</p>
<p>Behavior-driven development aims to mitigate that risk, by capturing and testing requirements from the perspective of the external user of the system.</p>
<section class="section level3"><h3 id="how-bdd-works">How BDD works<a class="anchor" aria-label="anchor" href="#how-bdd-works"></a>
</h3>
<p>Whether we’re working with a Product Owner, with users, or by ourselves, BDD can help us explore and define the problem in a structured way.</p>
<p>The process is as follows:</p>
<ol type="1">
<li>We capture a vague wish with a User Story.</li>
<li>We refine the User Story into examples. Those examples describe how we can tell if the wish has been fulfilled. Focus on what you want to achieve, not how to achieve it.</li>
<li>We create specifications. They are direct translations of examples into code.</li>
</ol>
<p>This helps us move from a vague description to a very precise, testable specification.</p>
</section><section class="section level3"><h3 id="capturing-a-wish-with-a-user-story">Capturing a wish with a User Story<a class="anchor" aria-label="anchor" href="#capturing-a-wish-with-a-user-story"></a>
</h3>
<p>Let’s imagine we want to implement a bookstore. The first User Story could be:</p>
<blockquote>
<p>As a customer, I want to select a book and add it to cart so that I can buy it.</p>
</blockquote>
</section><section class="section level3"><h3 id="refining-the-user-story-into-examples">Refining the User Story into examples<a class="anchor" aria-label="anchor" href="#refining-the-user-story-into-examples"></a>
</h3>
<p>Behavior-Driven Development helps us focus on behavior, by using a language that expresses behavior:</p>
<ul>
<li>
<strong>Given</strong> some context,</li>
<li>
<strong>When</strong> an event occurs,</li>
<li>
<strong>Then</strong> an outcome should be observed.</li>
</ul>
<p>In this example, we could write:</p>
<ul>
<li>Given I am in the bookstore</li>
<li>When I select “The Hobbit, J.R.R. Tolkien”</li>
<li>When I add selected book to the cart</li>
<li>Then I should see “The Hobbit, J.R.R. Tolkien” in the cart</li>
</ul>
<p>This description is more precise than the User Story. It describes what needs to happen, what the user needs to do, and what result the user should see.</p>
<p>At this level, we don’t know anything about the implementation of the bookstore. This description fits any implementation of the bookstore:</p>
<ul>
<li>it could be a web application,</li>
<li>it could be a CLI application,</li>
<li>or it could be a physical store with a robot assistant.</li>
</ul>
<p>The implementation can be changed at any moment, and executing the specification should tell us if the system allows the user to achieve their goal.</p>
</section><section class="section level3"><h3 id="implementing-executable-specifications">Implementing executable specifications<a class="anchor" aria-label="anchor" href="#implementing-executable-specifications"></a>
</h3>
<p>Specifications implemented with Behavior-Driven Development are:</p>
<ul>
<li>instantly readable,</li>
<li>focused on the business goal,</li>
<li>hiding the implementation details,</li>
<li>encouraging reuse of test code.</li>
</ul>
<p>Behavior-Driven Development is not about tools. It’s a way of building software. We can implement specifications in any way we want, however, there are tools that can help us. {cucumber} is one of them.</p>
</section><section class="section level2"><h2 id="bdd-with-base-r">BDD with base R<a class="anchor" aria-label="anchor" href="#bdd-with-base-r"></a>
</h2>
<p>We can practice BDD using base R. Having a set of examples of how the system should work, we need to establish a way of translating examples to code.</p>
<p>We need to represent the business language with code – a set of actions that user of the system can take. We can do it with functions. Those functions will create the interface of the system. Their names can follow closely the natural language description of the action. They will abstract and hide the implementation details of the system. They will allow reuse of the test code.</p>
<p>The specification of the bookstore could look like this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># tests/testthat/test-bookstore.R</span></span>
<span><span class="fu">test_that</span><span class="op">(</span><span class="st">"Bookstore: Adding a book to cart"</span>, <span class="op">{</span></span>
<span>  <span class="co"># Given</span></span>
<span>  <span class="va">bookstore</span> <span class="op">&lt;-</span> <span class="va">Bookstore</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="co"># When</span></span>
<span>  <span class="va">bookstore</span><span class="op">$</span><span class="fu">select</span><span class="op">(</span><span class="st">"The Hobbit, J.R.R. Tolkien"</span><span class="op">)</span></span>
<span>  <span class="va">bookstore</span><span class="op">$</span><span class="fu">add_to_cart</span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="co"># Then</span></span>
<span>  <span class="va">bookstore</span><span class="op">$</span><span class="fu">cart_includes</span><span class="op">(</span><span class="st">"The Hobbit, J.R.R. Tolkien"</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="co">#&gt; ── Error: Bookstore: Adding a book to cart ─────────────────────────────────────</span></span>
<span><span class="co">#&gt; Error in `eval(code, test_env)`: object 'Bookstore' not found</span></span>
<span><span class="co">#&gt; Error:</span></span>
<span><span class="co">#&gt; ! Test failed</span></span></code></pre></div>
</div>
<p>This test fails as the code doesn’t exist yet. We can pause in this step and try out a few versions of the specifications and go with one that expresses the business goal the best.</p>
<p>Once we have an outline of actions, we can implement them. We can use R6 objects to bind the functions together.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># tests/testthat/setup-bookstore.R</span></span>
<span><span class="va">Bookstore</span> <span class="op">&lt;-</span> <span class="fu">R6</span><span class="fu">::</span><span class="kw"><a href="https://r6.r-lib.org/reference/R6Class.html" class="external-link">R6Class</a></span><span class="op">(</span></span>
<span>  public <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    select <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">title</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span>    <span class="op">}</span>,</span>
<span>    add_to_cart <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span>    <span class="op">}</span>,</span>
<span>    cart_includes <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">title</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<p>When we have a skeleton of the implementation, we can start filling it with the actual code.</p>
<p>For example, our implementation of the bookstore might be a package with:</p>
<ul>
<li>
<code>select_book</code>: function that returns a tibble with book details,</li>
<li>
<code>add_to_cart</code>: function that adds a book with given ID to a storage,</li>
<li>
<code>get_cart</code>: function that returns a list with details of books in the cart.</li>
</ul>
<p>An implementation that satisfies the specification could be as simple as:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">storage</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">books</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>id <span class="op">=</span> <span class="fl">1</span>, title <span class="op">=</span> <span class="st">"The Hobbit, J.R.R. Tolkien"</span><span class="op">)</span>,</span>
<span>  <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>id <span class="op">=</span> <span class="fl">2</span>, title <span class="op">=</span> <span class="st">"The Lord of the Rings, J.R.R. Tolkien"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">select_book</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">title</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">books</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/keep.html" class="external-link">keep</a></span><span class="op">(</span>\<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">$</span><span class="va">title</span> <span class="op">==</span> <span class="va">title</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/pluck.html" class="external-link">pluck</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">add_to_cart</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">id</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">storage</span> <span class="op">&lt;&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">storage</span>, <span class="va">id</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">get_cart</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">books</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/keep.html" class="external-link">keep</a></span><span class="op">(</span>\<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">$</span><span class="va">id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">storage</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<p>Having this implementation, we can plug it into the test code:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># tests/testthat/setup-bookstore.R</span></span>
<span><span class="va">Bookstore</span> <span class="op">&lt;-</span> <span class="fu">R6</span><span class="fu">::</span><span class="kw"><a href="https://r6.r-lib.org/reference/R6Class.html" class="external-link">R6Class</a></span><span class="op">(</span></span>
<span>  private <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    selected_id <span class="op">=</span> <span class="cn">NULL</span></span>
<span>  <span class="op">)</span>,</span>
<span>  public <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    select <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">title</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">private</span><span class="op">$</span><span class="va">selected_id</span> <span class="op">&lt;-</span> <span class="fu">select_book</span><span class="op">(</span><span class="va">title</span><span class="op">)</span><span class="op">$</span><span class="va">id</span></span>
<span>    <span class="op">}</span>,</span>
<span>    add_to_cart <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="fu">add_to_cart</span><span class="op">(</span><span class="va">private</span><span class="op">$</span><span class="va">selected_id</span><span class="op">)</span></span>
<span>    <span class="op">}</span>,</span>
<span>    cart_includes <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">title</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/expect_setequal.html" class="external-link">expect_in</a></span><span class="op">(</span><span class="va">title</span>, <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map_chr</a></span><span class="op">(</span><span class="fu">get_cart</span><span class="op">(</span><span class="op">)</span>, <span class="st">"title"</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<p>Now, the tests pass.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># tests/testthat/test-bookstore.R</span></span>
<span><span class="fu">test_that</span><span class="op">(</span><span class="st">"Bookstore: Adding a book to cart"</span>, <span class="op">{</span></span>
<span>  <span class="co"># Given</span></span>
<span>  <span class="va">bookstore</span> <span class="op">&lt;-</span> <span class="va">Bookstore</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="co"># When</span></span>
<span>  <span class="va">bookstore</span><span class="op">$</span><span class="fu">select</span><span class="op">(</span><span class="st">"The Hobbit, J.R.R. Tolkien"</span><span class="op">)</span></span>
<span>  <span class="va">bookstore</span><span class="op">$</span><span class="fu">add_to_cart</span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="co"># Then</span></span>
<span>  <span class="va">bookstore</span><span class="op">$</span><span class="fu">cart_includes</span><span class="op">(</span><span class="st">"The Hobbit, J.R.R. Tolkien"</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="co">#&gt; Test passed 😸</span></span></code></pre></div>
</div>
<p>With this implementation, we can easily extend tests with checking if we can add multiple books to the cart.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">test_that</span><span class="op">(</span><span class="st">"Bookstore: Adding multiple books to cart"</span>, <span class="op">{</span></span>
<span>  <span class="co"># Given</span></span>
<span>  <span class="va">bookstore</span> <span class="op">&lt;-</span> <span class="va">Bookstore</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="co"># When</span></span>
<span>  <span class="va">bookstore</span><span class="op">$</span><span class="fu">select</span><span class="op">(</span><span class="st">"The Hobbit, J.R.R. Tolkien"</span><span class="op">)</span></span>
<span>  <span class="va">bookstore</span><span class="op">$</span><span class="fu">add_to_cart</span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="va">bookstore</span><span class="op">$</span><span class="fu">select</span><span class="op">(</span><span class="st">"The Lord of the Rings, J.R.R. Tolkien"</span><span class="op">)</span></span>
<span>  <span class="va">bookstore</span><span class="op">$</span><span class="fu">add_to_cart</span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="co"># Then</span></span>
<span>  <span class="va">bookstore</span><span class="op">$</span><span class="fu">cart_includes</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"The Hobbit, J.R.R. Tolkien"</span>, <span class="st">"The Lord of the Rings, J.R.R. Tolkien"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="co">#&gt; Test passed 🥳</span></span></code></pre></div>
</div>
<p>As the system grows, it will be extended with more examples and more actions. Actions already implemented will be reused in different scenarios.</p>
<p>The implementation of the system will evolve, so will specifications, but this approach will ensure that test code is easy to maintain and focused on the business goal.</p>
</section><section class="section level2"><h2 id="bdd-with-cucumber">BDD with {cucumber}<a class="anchor" aria-label="anchor" href="#bdd-with-cucumber"></a>
</h2>
<p>The steps of BDD with {cucumber} are the same as with base R. The difference in how we express specifications and their implementation.</p>
<p>The readability of specifications is given by them being expressed in <a href="https://cucumber.io/docs/gherkin/reference/" class="external-link">Gherkin</a> language. Specifications are no longer expressed in code, but as text. It adds another level of separation between the specification and the implementation.</p>
<p>We start by writing a feature file:</p>
<pre class="gherkin"><code># tests/acceptance/bookstore.feature
Feature: Bookstore
  Scenario: Adding a book to cart
    Given I am in the bookstore
    When I select "The Hobbit, J.R.R. Tolkien"
    When I add selected book to the cart
    Then I should see "The Hobbit, J.R.R. Tolkien" in the cart</code></pre>
<p>We implement actions with <code>given</code>, <code>when</code>, and <code>then</code> functions:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># tests/acceptance/steps/steps.R</span></span>
<span><span class="fu"><a href="../reference/step.html">given</a></span><span class="op">(</span><span class="st">"I am in the bookstore"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">context</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/step.html">when</a></span><span class="op">(</span><span class="st">"I select {string}"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">title</span>, <span class="va">context</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">context</span><span class="op">$</span><span class="va">selected_id</span> <span class="op">&lt;-</span> <span class="fu">select_book</span><span class="op">(</span><span class="va">title</span><span class="op">)</span><span class="op">$</span><span class="va">id</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/step.html">when</a></span><span class="op">(</span><span class="st">"I add selected book to the cart"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">context</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">add_to_cart</span><span class="op">(</span><span class="va">context</span><span class="op">$</span><span class="va">selected_id</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/step.html">then</a></span><span class="op">(</span><span class="st">"I should see {string} in the cart"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">title</span>, <span class="va">context</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">expect_in</span><span class="op">(</span><span class="va">title</span>, <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map_chr</a></span><span class="op">(</span><span class="fu">get_cart</span><span class="op">(</span><span class="op">)</span>, <span class="st">"title"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
</div>
<p>This test does exactly the same as the test with base R.</p>
<p>We can run those tests with:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">cucumber</span><span class="fu">::</span><span class="fu"><a href="../reference/test.html">test</a></span><span class="op">(</span><span class="st">"tests/acceptance"</span>, <span class="st">"tests/acceptance/steps"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Test passed</span></span></code></pre></div>
<p>What <code><a href="../reference/test.html">cucumber::test</a></code> function does is it reads the feature files, finds corresponding actions implementations and runs them in order. To learn more how it works, refer to <a href="https://jakubsob.github.io/cucumber/articles/how-it-works.html">How it works</a> vignette.</p>
<p>Similar to what we did with base R, we can extend the feature file with a scenario that checks if we can add multiple books to the cart:</p>
<pre class="gherkin"><code># tests/acceptance/bookstore.feature
Feature: Bookstore
  Scenario: Adding a book to cart
    Given I am in the bookstore
    When I select "The Hobbit, J.R.R. Tolkien"
    When I add selected book to the cart
    Then I should see "The Hobbit, J.R.R. Tolkien" in the cart

  Scenario: Adding multiple books to cart
    Given I am in the bookstore
    When I select "The Hobbit, J.R.R. Tolkien"
    When I add selected book to the cart
    When I select "The Lord of the Rings, J.R.R. Tolkien"
    When I add selected book to the cart
    Then I should see "The Hobbit, J.R.R. Tolkien" in the cart
    Then I should see "The Lord of the Rings, J.R.R. Tolkien" in the cart</code></pre>
<p>Reruning the tests will result in two scenarios passing.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">cucumber</span><span class="fu">::</span><span class="fu"><a href="../reference/test.html">test</a></span><span class="op">(</span><span class="st">"tests/acceptance"</span>, <span class="st">"tests/acceptance/steps"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Test passed</span></span>
<span><span class="co">#&gt; Test passed</span></span></code></pre></div>
</section><section class="section level2"><h2 id="why-should-you-choose-cucumber">Why should you choose {cucumber}?<a class="anchor" aria-label="anchor" href="#why-should-you-choose-cucumber"></a>
</h2>
<ul>
<li>It allows you to start practicing BDD without having to figure out how to glue actions implementations on your own.</li>
<li>It allows you to express high-level tests in a natural language.</li>
<li>It helps you keep the separation between the specification and the implementation.</li>
<li>It helps you extend and reuse test code.</li>
</ul></section><section class="section level2"><h2 id="learning-bdd">Learning BDD<a class="anchor" aria-label="anchor" href="#learning-bdd"></a>
</h2>
<ul>
<li>ATDD by Example: A Practical Guide to Acceptance Test-Driven Development: A Practical Guide to Acceptance TestDriven Development.</li>
<li><a href="https://www.youtube.com/watch?v=gXh0iUt4TXA&amp;list=PLwLLcwQlnXByKR1Fo7UnE6gQAbx-JfYJZ" class="external-link">Continuous Delivery Youtube Channel</a></li>
<li><a href="https://cucumber.io/docs/guides/" class="external-link">Cucumber</a></li>
</ul></section><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'light-border',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config);
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script></main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jakub Sobolewski.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
